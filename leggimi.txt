+ Implementazione interfaccia: Appendix B.

crmapp-2.0.3		    07-06-2016
- Capitolo 5 User Autenticazione
  - ./yii migrate/create init_user_table
  - ./yii migrate
  - Generato modello app\models\user\UserRecord
  - Generato CRUD utilizzando questi percorsi:
      modello    : app\models\user\UserRecord
	  search     : app\models\user\UserSearchModel
	  controller : app\controllers\UsersController
	  view       : @app/views/users
  - Implementato Test per tabella user. Si potevano duplicare quelli per la tabella
    services e sostituire i riferimenti a service in user. Preferito copiarli da
    crmapp-book: CRMUsersManagementSteps modificando il namespace in Step\Acceptance
	 e RegisterNewUserCept, DeleteUserCept, EditUserCept modificando la prima riga 
    $I = new Step\Acceptance\CRMUsersManagementSteps($scenario)
  - Scaricata ultima versione selenium-server-standalone-2.53.0 e aggiunto in  
    acceptance.suite.yml 
        - WebDriver:
            url: 'http://localhost/crmapp/web'
            browser: firefox
    Nell'eseguire i test da errore fatale:
    Cannot redeclare _generated\AcceptanceTesterActions::switchToIFrame() 
	in D:\xampp\htdocs\crmapp\tests\_support\_generated\AcceptanceTesterActions.php 
	on line 2701.
	Rinomino tale funzione in xswitchToIFrame() e funzionano tutti i test, compreso
	i Delete visto che adesso wait(1) funziona.
  - Resta un errore nei test RegisterNew quando i record superano i 20. Dovrebbe 
    spostarsi sull'ultima pagina dopo l'aggiunta di un record:
    - Modificato CRMUsersManagementSteps->seeUserInList aggiungendo
			$I->click(['css' => 'li[class=next] a']);
  - Modificato allo stesso modo CRMServicesManagementSteps->seeServiceInList.
  - Rimesso in rem le ultime due modifiche, perche' e' necessario valutare il caso 
    in cui i record sono inferiori di 22 e non c'e' il tasto >> e inoltre se sono 
	piu di tre pagine cmq non funziona. Infine il test sul delete non va!
  - Ogni volta che si modifica il file tests/_support/Helper/Acceptance.php (come per
    aggiungere la funzione seePageHasElement) viene ricreato AcceptanceTesterActions
	con l'errore su switchToIFrame()!!
  - Modificata nella vista index.php di users la paginazione per first e last, 
    e modificato il test in modo che da click(['css' => 'li[class=next] a']) che 
	puntava al tasto >> al click(['link' => 'last'])che punta al tasto last.
  - Modificata paginazione per users. In UserController->actionIndex() inserito
		        $dataProvider->pagination = ['pageSize'=>6];
  - Inserito ciclo in RegisterNewUserCept per inserire 20 utenti a test :
    - azzerata tabella users e eseguito solo RegisterNewUserCept: OK.
  - Messo in rem il ciclo in RegisterNewUserCept. Inserito in 
    CRMServicesManagementSteps->seeUserInList
		if ($I->seePageHasElement(['link' => 'last'])) {
			$I->click(['link' => 'last']);
		}
    e modificato nella vista index.php di services la paginazione x first e last e 
	in ServicesController->actionIndex pagination di dataProvider.
  - Eseguito cept run: da errore sui test EditServiceCept e EditUserCept.
    La funzione seeEditButtonBesideService di CRMServicesManagementSteps
	prima di eseguire $I->seeElement($xpath) deve posizionarsi sull'eventuale
	ultima pagina: 		
	    if ($I->seePageHasElement(['link' => 'last'])) {
			$I->click(['link' => 'last']);
		}
	Stessa cosa in CRMUsersManagementSteps->seeEditButtonBesideService.
  - Eseguito cept run: da errore sul test QueryCustomByPhoneNumberCept (non sempre!)
    cmq tolta la duplicazione $I->amInQueryCustomerUi e $I->amInAddCustomerUi
    (vedi crmapp-1.1.2)	e inserito un $I->wait(1) in submitCustomerDataForm
	di CRMOperatorSteps visto che sembra un problema di velocita/risorse.
  - Eseguito cept run: Da errore nel caso i due record aggiunti sono uno in una
    pagina e l'altro nella successiva. Messo in rem $I->seeUserInList($first_user)
    e $I->seeServiceInList($first_service) nei rispettivi RegisterNewxxxxCept.	
  - Eseguito cept run: OK - Rifatto con db vuoto: OK-.
  - Creato dump database per test funzionale sulla password. Configurato file
    functional.suite.yml e dopo cept build creato test:
       cept generate:test functional PasswordHashing
    Copiato il test dal book con i seguenti adattamenti:
    - E' testMe che chiama il test con $this->PasswordIsHashedWhenSavingUser() 
    - Dava un errore di dns, risolto configurando codeception.yml.
  - Adattato beforeSave e aggiunta una migrazione per il campo auth_key  
  - Eseguito test: Esito ok.
  - Implementato actionLogin, la vista e il modello LoginForm.Prova di 
    funzionamento: OK.
  - Implemetato actionLogout.
  - Aggiustato il test LoginAndLogoutCept: Ok.
  - Terminato capitolo 5.
  - Dal branch userauth eseguire
    - git add.
    - git commit -m "crmapp-2.0.3"
    - git checkout master
    - git merge userauth
    - git branch -d userauth
----------------------------------------------------------------------------------   
crmapp-2.0.2		    01-06-2016
- Customer Response Formatter
  - Nel namespace app\utilities creata classe YamlResponseFormatter che 
    implementa ResponseFormatterInterface. Creata sua funzione format che usa 
	Symfony\Component\Yaml\Yaml:Dump. Attivato in web.php nella sezione components
				'response' => [
					'formatters' => [
						'yaml' => [
							'class' => 'app\utilities\YamlResponseFormatter'
						]
					[
				]
  - Nel controller ServiceController creata actionYaml che mette in $data l'array
    con tutti i record della tabella services e dopo settato response->format='yaml'
	associa a response->data=$data.
- Implementato AssetBundler ApplicationUiAssetBundle che registra nella vista 
				  assets/ui/css/main.css
				  assets/ui/js/main.js
- Implementato un theme alla vista homepage:
  - Creato themes/snowy/views/site/homepage.php
  - In assets creato SnowAssetsBundle che registra assets/snow/snow.css
  - In web.php nella sezione components
				'view' => [
					'theme' => [
						'class' => yii\base\Theme::className(),
						'basePath' => '@app/themes/snowy',
					]
				]						
----------------------------------------------------------------------------------   
crmapp-2.0.1		    30-05-2016
- Aggiunto branch: git checkout -b markrenderer
- alias cept="./vendor/bin/codecept"
  cept generate:cept acceptance Documentation
	- Crea uno script che inizia con $I=new AcceptanceTester($scenario), modificata
		in $I=new Step\Acceptance\CRMUserSteps($scenario) perche' e' in quest'ultima 
		classe che viene implementata la funzione seeLargeBodyOfText() che chiamate
		seeContentIsLong (un wrap di assertGreaterThen) quindi implementato nella 
        classe Helper\Acceptance ( tests/_support/Helper/Acceptance.php).
    - Implementata azione e vista.
    - cept build
    - cept run 	tests/acceptance/DocumentationCept.php - Da Ok se momentaneamente 
	  mettiamo in docindex.md un <h1> iniziale e poi un <p> prima del paragrafo.
	- Rimettiamo file docindex con codifica Markdown e creiamo in utilities oggetto
	  MarkdownRenederer che estende ViewRenderer e modificato file config/web.php 
	  nella sezione componenets :
        'view' => [
			'renderers' => [
				'md' => [
				'class' => 'app\utilities\MarkdownRenderer'
				]
			]
		],	  
 - Dal branch markrenderer eseguire
   - git add.
   - git commit -m "implementato markdown renderer"
   - git checkout master
   - git merge markrenderer
   - git branch -d markrenderer
   N.B: Se vogliamo annullare anche fisicamente le modifiche e tornare a crmapp-2.0.0
        dopo il commit, eseguire : 
        - git reset --hard HEAD^   
----------------------------------------------------------------------------------
crmapp-2.0.0		    29-05-2016
- Composer update: ok
- Modificato il migrate della tabella phone: eliminato errore UNIQUE su customer_id.
- Unificati i controller in utilities/SubmodelController.
- Terminato capitolo 3 ed eseguito commit di git, cercando di mantenere la versione
  allinieata a questo leggimi.txt.

			    20-05-2016
- Dopo la migrazione per service e la moddifica di main.php, copiati il step object    
  CRMServicesManagementSteps in D:\xampp\htdocs\crmapp\tests\_support\Step\Acceptance.
  Modificato namespace e copiati i seguenti acceptance tester:
   -  RegisterNewServiceCept
   -  EditServiceCept
   +  DeleteServiceCept (da errore su seeInPopup - vedi note vers. 1.1.2) 

			    16-05-2016
- Passaggio a php 7
  - La nuova versione di codeception quando crea un stepobject lo crea in:
     D:\xampp\htdocs\crmapp\tests\_support\Step\Acceptance
    Affinche esso funziona e' necessario inizializzarlo in QueryCustomByPhoneNumberCept:          
	   $I = new Step\Acceptance\CRMOperatorSteps($scenario);
----------------------------------------------------------------------------------	   
crmapp-1.0.0                10-01-2015
- risolto problema published per vendor/bower/jquery/dist:
  - aggiornato globalmente package  fxp/composer-asset-plugin-1.0.0-beta4.
  - aggiornati i package di crmapp con composer update.(l'errore c'e' ancora).
  - aggiunto a composer.json :
    	"extra": {
        
		"asset-installer-paths": {
            
			"npm-asset-library": "vendor/npm",
            
			"bower-asset-library": "vendor/bower"
        
		}
    
	}
  - Siccome composer update da un errore di aggiornamento del package 
    bower-asset/jquery2.1.*@stable eseguito comando
    composer require --pref-dist bower-asset/bootstrap "*"
    Eseguito composer update con esito OK. 
- risolto problema che l'activeform non salva niente nel database:
  - modificato la rule per la data in CustomerRecord :
      ... 
      ['birth_date', 'date', 'format' => 'php:Y-m-d'],
      ...
- Attenzione al redirect ad esempio $this->redirect('/customer') punta a 
  localhost/customer. E' necessario scrivere $this->redirect(['/customers']).
- Il metodo CustomerController->actionAdd puo' essere scritto:
    public function actionAdd()
	
    {
      if (($customer->load(Yii::$app->request->post()) && 
           
           $phone->load(Yii::$app->request->post())) && 
           $this->store($customer,$phone)) {
           
     
            return $this->redirect(['/customers']);
        
      } else {
				
                 return $this->render('add', compact('customer', 'phone'));
        
      }
    }
  dove il metodo store e' cosi' definito:
    private function store(CustomerRecord $customer_record, PhoneRecord $phone_record)
   
    {
   	
	if ($customer_record->save())
 {
			
		$phone_record->customer_id = $customer_record->id;
   
		if ($phone_record->save())
				 
			return true;	
   	
        }
   	
	return false;
		   
   
    }    
----------------------------------------------------------------------------------
crmapp-1.1.0
- Aggiustata test codeception:
 - Modificato la funzione CRMUserSteps->fillInPhoneFieldWithDataFrom cambiano la riga
	'PhoneRecord[number]', $customer_data['PhoneRecord[number]']
   in
	'phone_number', $customer_data['PhoneRecord[number]']
- creata tabella services tramite ./yii migrate
- Installato yiisoft-yii2-gii che installa anche 
	bower-asset/typeahead.js
	phpspec/php-diff
	yiisoft/yii2-bootstrap
----------------------------------------------------------------------------------
crmapp-1.1.1
- Aggiuistato i test acceptance (tranne DeleteServiceCept):
 - Copiati i file CRMServicesManagementSteps, DeleteServiceCept, EditServiceCept e 
   RegisterNewServiceCept.
 - Modificato CRMServicesManagementSteps:
   1.-  class CRMServicesManagementSteps extends CRMGuestSteps ---->  
	class CRMServicesManagementSteps extends \AcceptanceTester
   2.-  $I->seeCurrentUrlEquals('/services/create');   ---->
        $I->seeCurrentUrlMatches('/services\/create/');
   3,. Messi in rem le due chiamate a $I->wait(1);
----------------------------------------------------------------------------------
crmapp-1.1.2
- Prova webdriver test
 -Aggiustati i 5 test. Ma e' necessario usare il server selenium. Con phantomjs 
  funzionano solo 4 test tranne DeleteServiceCept, perche' non funziona seeInPopup!
 -Inoltre stranamente il test QueryCustomerByPhoneNumberCept, dava errore. Per 
  risolvere duplicate le righe $I->amInAddCustomerUi() e $I->amInQueryCustomerUi()!!!
